apiVersion: v1
kind: ConfigMap
metadata:
  name: {{ include "vergate.fullname" . }}-config
  namespace: {{ .Release.Namespace }}
  labels:
    {{- include "vergate.labels" . | nindent 4 }}
data:
  SPRING_PROFILES_ACTIVE: {{ .Values.config.springProfilesActive | quote }}
  VERGATE_CACHE_INIT_TTL_SECONDS: {{ .Values.config.cache.initTtlSeconds | quote }}
  {{- if .Values.postgresql.enabled }}
  DATABASE_URL: {{ printf "jdbc:postgresql://%s:5432/%s" (include "vergate.postgresHost" .) .Values.postgresql.database | quote }}
  DATABASE_USERNAME: {{ .Values.postgresql.username | quote }}
  {{- end }}
  {{- if .Values.valkey.enabled }}
  REDIS_HOST: {{ include "vergate.valkeyHost" . | quote }}
  REDIS_PORT: "6379"
  {{- end }}
